<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Detail</title>
  <link rel="stylesheet" href="assets/vendors/themify-icons/css/themify-icons.css">
  <link rel="stylesheet" href="assets/css/meyawo.css" />
  <link rel="stylesheet" href="assets/css/custom.css" />
</head>
<body data-spy="scroll" data-target=".navbar" data-offset="40">
  <nav class="custom-navbar navbar-solid" data-spy="affix" data-offset-top="20">
    <div class="container">
      <a class="logo" href="index.html#home">Meyawo</a>
      <ul class="nav">
        <li class="item"><a class="link" href="index.html#home">Home</a></li>
        <li class="item"><a class="link" href="about.html">About</a></li>
        <li class="item"><a class="link" href="store.html">Store</a></li>
        <li class="item"><a class="link" href="cart.html">Cart <span id="nav-cart-count" class="badge badge-primary"></span></a></li>
        <li class="item"><a class="link" href="login.html">Login</a></li>
        <li class="item"><a class="link" href="signup.html">Sign Up</a></li>
      </ul>
      <a href="javascript:void(0)" id="nav-toggle" class="hamburger hamburger--elastic">
        <div class="hamburger-box"><div class="hamburger-inner"></div></div>
      </a>
    </div>
  </nav>
  <div class="container page-section-spacer">
    <div id="product-detail" class="row"></div>
  </div>
  <script src="assets/vendors/jquery/jquery-3.4.1.js"></script>
  <script src="assets/vendors/bootstrap/bootstrap.bundle.js"></script>
  <script src="assets/vendors/bootstrap/bootstrap.affix.js"></script>
  <script src="assets/js/products.js"></script>
  <script src="assets/js/meyawo.js"></script>
  <script>
    function updateCartBadge(){
      const cart = JSON.parse(localStorage.getItem('cart')||'[]');
      const count = cart.reduce((s,i)=>s+i.qty,0);
      document.getElementById('nav-cart-count').textContent = count?count:'';
    }
    const getParam = n => new URLSearchParams(location.search).get(n);
    function render(){
      const id = parseInt(getParam('id'),10);
      const product = PRODUCTS.find(p=>p.id===id);
      const wrap = document.getElementById('product-detail');
      if(!product){ wrap.innerHTML='<div class="col-12"><p>Product not found.</p></div>'; return; }
      wrap.innerHTML=`<div class=\"col-lg-6 mb-4 mb-lg-0\"><img src=\"${product.img}\" alt=\"${product.name}\" class=\"img-fluid product-hero-img\"></div>
      <div class=\"col-lg-6\">
        <h2>${product.name}</h2>
        <p class=\"text-muted mb-2\">Category: ${product.category}</p>
        <p>${product.description}</p>
        <p class=\"h4 font-weight-bold mb-4\">$${product.price.toFixed(2)}</p>
        <div class=\"d-flex align-items-center mb-3\">
          <label class=\"mr-2 mb-0\" for=\"qty\">Qty:</label>
          <input id=\"qty\" type=\"number\" value=\"1\" min=\"1\" class=\"form-control\" style=\"width:90px;\">
        </div>
        <button id=\"addBtn\" class=\"btn btn-gradient btn-lg\">Add to Cart</button>
        <a href=\"store.html\" class=\"btn btn-outline-primary ml-2\">Back to Store</a>
        <div class=\"feature-list mt-4\">
          <div><i class=\"ti-check\"></i> Premium Quality</div>
          <div><i class=\"ti-check\"></i> 1 Year Warranty</div>
          <div><i class=\"ti-check\"></i> Fast Shipping</div>
          <div><i class=\"ti-check\"></i> 24/7 Support</div>
        </div>
      </div>
      <div class=\"col-12 mt-5\">
        <div class=\"tab-nav mb-3\">
          <button class=\"active\" data-tab=\"desc\">Description</button>
          <button data-tab=\"specs\">Specs</button>
          <button data-tab=\"reviews\">Reviews</button>
        </div>
        <div class=\"tab-panel active\" id=\"tab-desc\"><p>${product.description}</p></div>
        <div class=\"tab-panel\" id=\"tab-specs\"><p>Specification data coming soon.</p></div>
        <div class=\"tab-panel\" id=\"tab-reviews\"><p>No reviews yet.</p></div>
      </div>
      <div class=\"col-12 mt-5\">
        <h4 class=\"mb-3\">Related Products</h4>
        <div class=\"related-grid\" id=\"related-grid\"></div>
      </div>`;
      document.getElementById('addBtn').addEventListener('click',()=>{
        const qty=Math.max(1,parseInt(document.getElementById('qty').value,10)||1);
        const cart=JSON.parse(localStorage.getItem('cart')||'[]');
        const existing=cart.find(c=>c.id===product.id);
        if(existing){existing.qty+=qty;}else{cart.push({id:product.id,name:product.name,price:product.price,qty,img:product.img});}
        localStorage.setItem('cart',JSON.stringify(cart));
        updateCartBadge();
        const btn=document.getElementById('addBtn');
        btn.textContent='Added!';
        setTimeout(()=>btn.textContent='Add to Cart',1200);
      });
      document.querySelectorAll('.tab-nav button').forEach(btn=>{
        btn.addEventListener('click',()=>{
          document.querySelectorAll('.tab-nav button').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          const target=btn.getAttribute('data-tab');
          document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
          const panel=document.getElementById('tab-'+target); if(panel) panel.classList.add('active');
        });
      });
      renderRelated(product);
    }
    function renderRelated(product){
      const related=PRODUCTS.filter(p=>p.category===product.category && p.id!==product.id).slice(0,4);
      const grid=document.getElementById('related-grid');
      grid.innerHTML=related.map(r=>`<div class=\"card product-card p-0 text-center\">
        <a href=\"product.html?id=${r.id}\"><img src=\"${r.img}\" alt=\"${r.name}\" style=\"height:120px;object-fit:cover;width:100%;\"/></a>
        <div class=\"p-2\">
          <h6 class=\"mb-1 text-truncate\">${r.name}</h6>
          <p class=\"small text-muted mb-2\">$${r.price.toFixed(2)}</p>
          <a href=\"product.html?id=${r.id}\" class=\"btn btn-sm btn-gradient\">View</a>
        </div>
      </div>`).join('');
    }
    render(); updateCartBadge();
  </script>
</body>
</html>
